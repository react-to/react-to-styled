import { Meta, Canvas, Story } from '@storybook/addon-docs'
import styled from 'styled-components'
import { useState } from '@storybook/addons'
import { Table, Paginator } from '@react-to-styled/table'

<Meta title="Table/All stories" component={Table} />

export const Wrapper = styled.div`
  padding: 2rem;
`

export const columns = {
  title: {
    header: 'Title',
    Cell: ({ data: { title } }) => <span>{title}</span>,
  },
  price: {
    header: 'Price',
    Cell: ({ data: { price } }) => <span>{price}</span>,
  },
}

export const mockedData = Array(100)
  .fill(true)
  .map((_, index) => ({
    title: `Row ${index + 1}`,
    price: (Math.random() * 100).toFixed(2),
  }))

export const Template = args => {
  const PAGE_LIMIT = 10
  const [data, setData] = useState(mockedData.slice(0, PAGE_LIMIT))
  const [currentPage, setCurrentPage] = useState(1)
  const onPagination = p => {
    setData(mockedData.slice(p * PAGE_LIMIT - PAGE_LIMIT, p * PAGE_LIMIT))
    setCurrentPage(p)
  }
  console.log(currentPage)
  return (
    <Wrapper>
      <Table
        {...args}
        columns={columns}
        currentPage={currentPage}
        onPagination={onPagination}
        data={data}
        pageLimit={PAGE_LIMIT}
        totalRecords={mockedData.length}
      />
    </Wrapper>
  )
}

<Canvas>
  <Story
    name="Lazy table"
    argTypes={{ currentPage: { defaultValue: 1, control: { type: 'number' } } }}
  >
    {Template.bind({})}
  </Story>
</Canvas>
